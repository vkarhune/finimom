---
title: "Multi-trait fine-mapping"
author: "Ville Karhunen"
date: "`r format(Sys.Date(), '%d.%m.%Y')`"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r workinprogress, echo = FALSE, out.width = '20%' }

knitr::include_graphics("work-in-progress.png")

```


This is a short tutorial for multi-trait fine-mapping.
Please note that the current implementation is tested for only two traits, and other number of traits may return an error.

Please report any unexpected behaviour to: ville dot karhunen at mrc-bsu.cam.ac.uk.

# Package installation and load

Make sure that you are using the most recent version of the package.

```{r setup, echo = FALSE}

# load required package
library(finimom)

```


```{r setup1, eval = FALSE}

# install package
# if needed, install also 'remotes' package via 'install.packages("remotes")'
remotes::install_github("vkarhune/finimom")

# load required package
library(finimom)

```



## Example data

```{r load exampledata}

load(url("https://github.com/vkarhune/finimomData/raw/main/multi-finimom_example.RData"))

ls()

# betas
beta <- list(summarystats_y1[,1], summarystats_y2[,1])
se <- list(summarystats_y1[,2], summarystats_y2[,2])

```

## Fine-mapping

```{r multitrait}

res <- multi_finimom(beta = beta, se = se, eaf = mafs, R = LDmat,
                    n = 50000, k = 2, omega = NULL,
                    niter = 62500, burnin = 12500,
                    standardize = TRUE,
                    verbose = TRUE,
                    insampleLD = FALSE,
                    clump = TRUE, clump_r2 = 0.995^2, check_ld = TRUE,
                    u = 1.05,
                    purity = 0.5)

res$sets

```

# Session information

```{r sessioninfo}

sessionInfo()

```
