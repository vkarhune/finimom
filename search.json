[{"path":"https://vkarhune.github.io/finimom/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 finimom authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://vkarhune.github.io/finimom/articles/betabinprior.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Beta-binomial prior for model dimension","text":"Castillo van der Vaart (2012). Needles Straw Haystack: Posterior concentration possibly sparse sequences. Annals Statistics. Castillo et al. (2015). Bayesian linear regression sparse priors. Annals Statistics.","code":""},{"path":"https://vkarhune.github.io/finimom/articles/betabinprior.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Beta-binomial prior for model dimension","text":"","code":"sessionInfo() #> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] finimom_0.1.0 #>  #> loaded via a namespace (and not attached): #>  [1] vctrs_0.6.4       cli_3.6.1         knitr_1.44        rlang_1.1.1       #>  [5] xfun_0.40         stringi_1.7.12    purrr_1.0.2       textshaping_0.3.7 #>  [9] jsonlite_1.8.7    glue_1.6.2        rprojroot_2.0.3   htmltools_0.5.6.1 #> [13] ragg_1.2.6        sass_0.4.7        rmarkdown_2.25    evaluate_0.22     #> [17] jquerylib_0.1.4   fastmap_1.1.1     yaml_2.3.7        lifecycle_1.0.3   #> [21] memoise_2.0.1     stringr_1.5.0     compiler_4.3.1    fs_1.6.3          #> [25] Rcpp_1.0.11       systemfonts_1.0.5 digest_0.6.33     R6_2.5.1          #> [29] magrittr_2.0.3    bslib_0.5.1       tools_4.3.1       pkgdown_2.0.7     #> [33] cachem_1.0.8      desc_1.4.2"},{"path":"https://vkarhune.github.io/finimom/articles/nonlocalpriors.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Non-local priors","text":"Giambartolomei et al. (2014). Bayesian Test Colocalisation Pairs Genetic Association Studies Using Summary Statistics. PLoS Genet. Johnson, Rossell (2010). use non-local prior densities Bayesian hypothesis tests. J. R. Statist. Soc. B. Johnson, Rossell (2012). Bayesian Model Selection High-Dimensional Settings. J Stat Assoc. Karhunen et al. (2023). Genetic fine-mapping summary data using nonlocal prior improves detection multiple causal variants. Bioinformatics. Sanyal et al. (2019). GWASinlps: non-local prior based iterative SNP selection tool genome-wide association studies. Bioinformatics. Wakefield (2009). Bayes factors genome-wide association studies: comparison P-values. Genet Epidemiol.","code":""},{"path":"https://vkarhune.github.io/finimom/articles/nonlocalpriors.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Non-local priors","text":"","code":"sessionInfo() #> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] finimom_0.1.0 #>  #> loaded via a namespace (and not attached): #>  [1] vctrs_0.6.4       cli_3.6.1         knitr_1.44        rlang_1.1.1       #>  [5] xfun_0.40         stringi_1.7.12    purrr_1.0.2       textshaping_0.3.7 #>  [9] jsonlite_1.8.7    glue_1.6.2        rprojroot_2.0.3   htmltools_0.5.6.1 #> [13] ragg_1.2.6        sass_0.4.7        rmarkdown_2.25    evaluate_0.22     #> [17] jquerylib_0.1.4   fastmap_1.1.1     yaml_2.3.7        lifecycle_1.0.3   #> [21] memoise_2.0.1     stringr_1.5.0     compiler_4.3.1    fs_1.6.3          #> [25] Rcpp_1.0.11       systemfonts_1.0.5 digest_0.6.33     R6_2.5.1          #> [29] magrittr_2.0.3    bslib_0.5.1       tools_4.3.1       pkgdown_2.0.7     #> [33] cachem_1.0.8      desc_1.4.2"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"package-installation-and-load","dir":"Articles","previous_headings":"","what":"Package installation and load","title":"Tutorial","text":"Make sure using recent version package.","code":"# install package # if needed, install also 'remotes' package via 'install.packages(\"remotes\")' remotes::install_github(\"vkarhune/finimom\")  # load required package library(finimom)"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"input-data","dir":"Articles","previous_headings":"","what":"Input data","title":"Tutorial","text":"input data, method requires effect sizes standard errors variant-phenotype associations within genetic region interest genome-wide association study (source GWAS). linkage disequilibrium (LD) matrix variants within genetic region. Additionally, recommended effect allele frequencies, source GWAS sample size, variance phenotype (source GWAS). phenotype variance \\(\\neq\\) 1, please scale effect sizes standard errors correspond standard-deviation units. Z-scores available, please see corresponding section .","code":""},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"example-data","dir":"Articles","previous_headings":"Input data","what":"Example data","title":"Tutorial","text":"R package comes simulated example dataset 363 genetic variants: object exampledata list, information GWAS estimated effect sizes (betahat), standard errors (sebetahat), allele frequencies (allelefreqs), true causal effect sizes (truebetas; simulated dataset known), indices true causal variants (causals), GWAS source sample size (n) LD reference sample size (n_ref) -sample LD matrix (insampleLD) reference, --sample, LD matrix (refLD) summary statistics can visualised via Manhattan plot. following figure, true causal variants also highlighted.  aim fine-mapping identify true causal variants (.e. red figure). FiniMOM, problem answered credible sets causal signals.","code":"str(exampledata) #> List of 9 #>  $ betahat   : num [1:363] 0.0804 0.0927 -0.0253 -0.0165 -0.0128 ... #>  $ sebetahat : num [1:363] 0.0601 0.0595 0.0968 0.028 0.0276 ... #>  $ allelefreq: num [1:363] 0.0527 0.0541 0.0194 0.3751 0.4224 ... #>  $ truebetas : num [1:363] 0 0 0 0 0 0 0 0 0 0 ... #>  $ causals   : num [1:3] 95 314 329 #>  $ n         : int 2763 #>  $ n_ref     : int 2637 #>  $ insampleLD: num [1:363, 1:363] 1 0.971 0.545 0.288 0.244 ... #>  $ refLD     : num [1:363, 1:363] 1 0.972 0.558 0.3 0.268 ... # effect size estimates and their standard errors beta <- exampledata$betahat se <- exampledata$sebetahat  # Z-scores zscores <- beta/se  # p-values pvals <- 2*pnorm(abs(zscores), lower.tail = FALSE)  # allele frequencies eaf <- exampledata$allelefreq  # LD matrix R <- exampledata$insampleLD  # Source GWAS sample size n <- exampledata$n plot(-log10(pvals), pch = 16, xlab = \"Genetic position\", ylab = bquote(-log[10](italic(p)))) points(exampledata$causals, -log10(pvals[exampledata$causals]), col = \"red\", pch = 16) legend(\"topleft\", legend = c(\"Causal\", \"Non-causal\"), col = c(\"red\", \"black\"), pch = 16)"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"selecting-hyperparameters","dir":"Articles","previous_headings":"","what":"Selecting hyperparameters","title":"Tutorial","text":"Two main hyperparameters need selected: \\(\\tau\\), controls prior detectable effect sizes, \\(u\\), controls prior number causal variants. default, \\(\\tau\\) estimated based sample size, \\(u = 2\\) -sample LD matrix, \\(u = 2.25\\) --sample LD matrix. See manuscript supplement details.","code":""},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"running-finimom","dir":"Articles","previous_headings":"","what":"Running finimom","title":"Tutorial","text":"output list, first element (samples) information Markov Chain Monte Carlo samples, second element (signals) posterior distribution number signals (credible sets), third element list obtained 95% credible sets. obtain variant-wise posterior inclusion probabilities, run","code":"out <- finimom(beta = beta, se = se, eaf = eaf, R = R,                n = n,                insampleLD = TRUE,                verbose = TRUE,                ala = TRUE) #> Calculating tau based on the sample size. #> Clumping variants at r2=0.98 #> Sampling from the posterior... #>  #> 12500 iterations done in 0.52 seconds names(out) #> [1] \"samples\" \"signals\" \"sets\"  # posterior distribution for the number of signals out$signals #>  #>      3      4      5  #> 0.9341 0.0628 0.0031  # credible sets out$sets #> [[1]] #>  [1] 295 300 301 309 310 314 315 316 317 322 327 330 342 345 351 353 #>  #> [[2]] #>  [1] 313 320 321 323 325 326 329 331 333 337 339 340 341 343 344 348 350 352 355 #> [20] 360 362 #>  #> [[3]] #>  [1]  39  55  63  68  69  72  73  74  75  76  77  78  79  81  82  83  85  86  87 #> [20]  88  90  92  93  94  95  96  97  99 114 116 117 118 124 126 128 129 131 133 #> [39] 136 147 149 150 151 159 pips <- get_pips(out$samples)"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"visualising-results","dir":"Articles","previous_headings":"","what":"Visualising results","title":"Tutorial","text":"One can extract credible sets visualise results e.g. follows:","code":"plot(-log10(pvals), pch = 16, xlab = \"Genetic position\", ylab = bquote(-log[10](italic(p)))) points(exampledata$causals, -log10(pvals[exampledata$causals]), col = \"red\", pch = 16) points(out$sets[[1]], -log10(pvals[out$sets[[1]]]), col = \"dodgerblue\", pch = 1, lwd = 2) points(out$sets[[2]], -log10(pvals[out$sets[[2]]]), col = \"orange\", pch = 1, lwd = 2) points(out$sets[[3]], -log10(pvals[out$sets[[3]]]), col = \"darkolivegreen\", pch = 1, lwd = 2) legend(\"topleft\", legend = c(\"Causal\", \"Non-causal\", \"Credible set 1\", \"Credible set 2\", \"Credible set 3\"),  col = c(\"red\", \"black\", \"dodgerblue\", \"orange\", \"darkolivegreen\"), pch = c(16, 16, 1, 1, 1))"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"using-out-of-sample-ld-matrix","dir":"Articles","previous_headings":"","what":"Using out-of-sample LD matrix","title":"Tutorial","text":"using LD matrix reference panel, set insampleLD = FALSE. addition, recommended check LD discrepancies check_ld = TRUE. case, variants multiple credible sets. behaviour can mitigated selecting desired purity level credible sets (minimum absolute correlation variants within credible set) using option purity:","code":"R_ref <- exampledata$refLD  out_refld <- finimom(beta = beta, se = se, eaf = eaf, R = R_ref,                n = n,                insampleLD = FALSE,                check_ld = TRUE,                verbose = TRUE,                ala = TRUE) #> Calculating tau based on the sample size. #> Clumping variants at r2=0.98 #> Sampling from the posterior... #>  #> 12500 iterations done in 0.62 seconds  out_refld$sets #> [[1]] #>  [1] 124 126 128 129 133 294 295 296 300 301 309 310 314 315 316 317 322 327 330 #> [20] 342 345 351 353 #>  #> [[2]] #>  [1] 313 320 321 323 325 326 329 331 333 337 339 340 341 343 344 348 350 352 355 #> [20] 360 362 #>  #> [[3]] #>  [1]  39  55  56  57  68  69  72  73  74  75  76  77  78  79  81  82  83  85  86 #> [20]  87  88  90  92  93  94  95  96  97  99 105 108 109 111 112 113 114 116 117 #> [39] 118 124 126 128 129 131 133 136 147 150 151 159 345 out_refld2 <- finimom(beta = beta, se = se, eaf = eaf, R = R_ref,                n = n,                insampleLD = FALSE,                check_ld = TRUE,                verbose = TRUE,                ala = TRUE,                purity = 0.5) #> Calculating tau based on the sample size. #> Clumping variants at r2=0.98 #> Sampling from the posterior... #>  #> 12500 iterations done in 0.52 seconds  out_refld2$sets #> [[1]] #>  [1] 294 295 296 300 301 309 310 314 315 316 317 322 327 330 342 345 351 353 #>  #> [[2]] #>  [1] 313 320 321 323 325 326 329 331 333 337 339 340 341 343 344 348 350 352 355 #> [20] 360 362 #>  #> [[3]] #>  [1]  39  55  57  68  69  72  73  74  75  76  77  78  79  81  82  83  85  86  87 #> [20]  88  90  92  93  94  95  96  97  99 114 124 126 128 129 131 133 147 150 151 #> [39] 159"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"using-z-scores","dir":"Articles","previous_headings":"","what":"Using Z scores","title":"Tutorial","text":"Z-scores available (.e. information effect sizes standard errors), standardized (mean = 0, standard deviation = 1) genetic variant phenotype, \\(\\text{SE}(\\hat{\\beta}) \\approx 1/\\sqrt{n}\\). (approximately) standardized scale, use option standardize = FALSE avoiding standardization done default.","code":"approx_se <- rep(1/sqrt(n), length(zscores))  approx_beta <- zscores*approx_se  out_zscore_only <- finimom(beta = approx_beta, se = approx_se,                            eaf = NULL,                            R = exampledata$insampleLD,                            n = exampledata$n,                            standardize = FALSE, # <--- use this option for Z-scores                            insampleLD = TRUE,                            ala = TRUE) #> Calculating tau based on the sample size. #> Clumping variants at r2=0.98 #> Sampling from the posterior... #>  #> 12500 iterations done in 0.52 seconds  out_zscore_only$sets #> [[1]] #>  [1] 295 300 309 310 314 315 317 322 327 330 342 345 351 353 #>  #> [[2]] #>  [1] 313 320 321 323 325 326 329 331 333 337 339 340 341 343 344 348 350 352 355 #> [20] 360 362 #>  #> [[3]] #>  [1]  55  63  68  69  72  73  74  75  76  77  78  79  81  82  83  85  86  87  88 #> [20]  90  92  93  94  95  96  97  99 114 116 117 118 124 126 128 129 131 133 136 #> [39] 147 150 151 159"},{"path":"https://vkarhune.github.io/finimom/articles/tutorial.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"Tutorial","text":"","code":"sessionInfo() #> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] finimom_0.1.0 #>  #> loaded via a namespace (and not attached): #>  [1] vctrs_0.6.4       cli_3.6.1         knitr_1.44        rlang_1.1.1       #>  [5] xfun_0.40         stringi_1.7.12    purrr_1.0.2       textshaping_0.3.7 #>  [9] jsonlite_1.8.7    glue_1.6.2        rprojroot_2.0.3   htmltools_0.5.6.1 #> [13] ragg_1.2.6        sass_0.4.7        rmarkdown_2.25    evaluate_0.22     #> [17] jquerylib_0.1.4   fastmap_1.1.1     yaml_2.3.7        lifecycle_1.0.3   #> [21] memoise_2.0.1     stringr_1.5.0     compiler_4.3.1    fs_1.6.3          #> [25] Rcpp_1.0.11       systemfonts_1.0.5 digest_0.6.33     R6_2.5.1          #> [29] magrittr_2.0.3    bslib_0.5.1       tools_4.3.1       pkgdown_2.0.7     #> [33] cachem_1.0.8      desc_1.4.2"},{"path":"https://vkarhune.github.io/finimom/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ville Karhunen. Author, maintainer.","code":""},{"path":"https://vkarhune.github.io/finimom/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Karhunen V (2023). finimom: Fine-mapping Using Inverse-Moment Prior. https://vkarhune.github.io/finimom, https://vkarhune.github.io/finimom/.","code":"@Manual{,   title = {finimom: Fine-mapping Using Inverse-Moment Prior},   author = {Ville Karhunen},   year = {2023},   note = {https://vkarhune.github.io/finimom, https://vkarhune.github.io/finimom/}, }"},{"path":"https://vkarhune.github.io/finimom/index.html","id":"finimom-","dir":"","previous_headings":"","what":"Fine-mapping Using Inverse-Moment Prior","title":"Fine-mapping Using Inverse-Moment Prior","text":"R package implements method fine-mapping summarised genetic data using product inverse-moment prior effect sizes, beta-binomial prior model dimension. method described : Karhunen V, Launonen , Järvelin MR, Sebert S, Sillanpää MJ. Genetic fine-mapping summary data using nonlocal prior improves detection multiple causal variants. Bioinformatics. doi:10.1093/bioinformatics/btad396.","code":""},{"path":"https://vkarhune.github.io/finimom/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Fine-mapping Using Inverse-Moment Prior","text":"can install finimom GitHub :","code":"# install.packages(\"remotes\") remotes::install_github(\"vkarhune/finimom\")"},{"path":"https://vkarhune.github.io/finimom/index.html","id":"minimal-example","dir":"","previous_headings":"","what":"Minimal example","title":"Fine-mapping Using Inverse-Moment Prior","text":"minimal example using finimom:","code":"# load package library(finimom)  # example data: str(exampledata) #> List of 9 #>  $ betahat   : num [1:363] 0.0804 0.0927 -0.0253 -0.0165 -0.0128 ... #>  $ sebetahat : num [1:363] 0.0601 0.0595 0.0968 0.028 0.0276 ... #>  $ allelefreq: num [1:363] 0.0527 0.0541 0.0194 0.3751 0.4224 ... #>  $ truebetas : num [1:363] 0 0 0 0 0 0 0 0 0 0 ... #>  $ causals   : num [1:3] 95 314 329 #>  $ n         : int 2763 #>  $ n_ref     : int 2637 #>  $ insampleLD: num [1:363, 1:363] 1 0.971 0.545 0.288 0.244 ... #>  $ refLD     : num [1:363, 1:363] 1 0.972 0.558 0.3 0.268 ...  # effect size estimates and their standard errors beta <- exampledata$betahat se <- exampledata$sebetahat  # allele frequencies eaf <- exampledata$allelefreq  # LD matrix R <- exampledata$insampleLD  # run finimom res <- finimom(beta = beta, se = se, eaf = eaf, R = R,                n = exampledata$n,                insampleLD = TRUE,                verbose = TRUE, ala = TRUE) # set ala = TRUE for approximate Laplace #> Calculating tau based on the sample size. #> Clumping variants at r2=0.98 #> Sampling from the posterior... #>  #> 12500 iterations done in 0.76 seconds  # output: credible sets res$sets #> [[1]] #>  [1] 295 300 301 309 310 314 315 316 317 322 327 330 342 345 351 353 #>  #> [[2]] #>  [1] 313 320 321 323 325 326 329 331 333 337 339 340 341 343 344 348 350 352 355 #> [20] 360 362 #>  #> [[3]] #>  [1]  39  55  63  68  69  72  73  74  75  76  77  78  79  81  82  83  85  86  87 #> [20]  88  90  92  93  94  95  96  97  99 114 116 117 118 124 126 128 129 131 133 #> [39] 136 147 149 150 151 159  # compare with the true causal variants exampledata$causals #> [1]  95 314 329  # check whether the true causals were captured in the credible sets lapply(res$sets, function(x) exampledata$causals %in% x) #> [[1]] #> [1] FALSE  TRUE FALSE #>  #> [[2]] #> [1] FALSE FALSE  TRUE #>  #> [[3]] #> [1]  TRUE FALSE FALSE"},{"path":"https://vkarhune.github.io/finimom/index.html","id":"further-details","dir":"","previous_headings":"","what":"Further details","title":"Fine-mapping Using Inverse-Moment Prior","text":"examples given articles. Please report bugs unexpected behaviour ville.karhunen@oulu.fi.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/check_ld_disc.html","id":null,"dir":"Reference","previous_headings":"","what":"Check discrepancy of the linkage equilibrium and test statistics — check_ld_disc","title":"Check discrepancy of the linkage equilibrium and test statistics — check_ld_disc","text":"Check discrepancy linkage equilibrium test statistics","code":""},{"path":"https://vkarhune.github.io/finimom/reference/check_ld_disc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check discrepancy of the linkage equilibrium and test statistics — check_ld_disc","text":"","code":"check_ld_disc(indices, z, Chi2_quantile = NULL, LDm, clump_r2)"},{"path":"https://vkarhune.github.io/finimom/reference/check_ld_disc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check discrepancy of the linkage equilibrium and test statistics — check_ld_disc","text":"indices Variant indices. z Test statistic. Chi2_quantile Quantile declaring mismatch. default median Chi-squared distribution one degree freedom. LDm LD matrix. clump_r2 Clumping threshold extremely highly correlated variants.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/check_ld_disc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check discrepancy of the linkage equilibrium and test statistics — check_ld_disc","text":"List indices within LD clump, corrected LD discrepancy.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/clump_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Clump highly correlated variants. — clump_variants","title":"Clump highly correlated variants. — clump_variants","text":"Clump highly correlated variants.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/clump_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clump highly correlated variants. — clump_variants","text":"","code":"clump_variants(R, clump_r2, z)"},{"path":"https://vkarhune.github.io/finimom/reference/clump_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clump highly correlated variants. — clump_variants","text":"R LD matrix. clump_r2 Clumping threshold r^2. z Z-scores.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/clump_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clump highly correlated variants. — clump_variants","text":"List variant indices within group.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/dbb.html","id":null,"dir":"Reference","previous_headings":"","what":"Beta-binomial density. — dbb","title":"Beta-binomial density. — dbb","text":"Beta-binomial density.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/dbb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Beta-binomial density. — dbb","text":"","code":"dbb(x, p, a, b, log = TRUE)"},{"path":"https://vkarhune.github.io/finimom/reference/dbb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Beta-binomial density. — dbb","text":"x Function argument. p Parameter p. Parameter . b Parameter b. log Whether log-density returned -- defaults TRUE.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/dbb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Beta-binomial density. — dbb","text":"(Log-)density value.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/dimom.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — dimom","title":"Title — dimom","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/dimom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — dimom","text":"","code":"dimom(x, r, tau, phi = 1)"},{"path":"https://vkarhune.github.io/finimom/reference/dimom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — dimom","text":"phi","code":""},{"path":"https://vkarhune.github.io/finimom/reference/estimate_tau.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate tau based on sample size and z score — estimate_tau","title":"Estimate tau based on sample size and z score — estimate_tau","text":"Estimate tau based sample size z score","code":""},{"path":"https://vkarhune.github.io/finimom/reference/estimate_tau.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate tau based on sample size and z score — estimate_tau","text":"","code":"estimate_tau(n = NULL, q = 0.05, pval = 0.001, z = NULL)"},{"path":"https://vkarhune.github.io/finimom/reference/estimate_tau.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate tau based on sample size and z score — estimate_tau","text":"n Sample size GWAS summary statistics q Quantile proposed Z score pval P-value threshold detectable effect size (z-score used p-value z-score provided) z Z-score detectable effect size (z-score used p-value z-score provided)","code":""},{"path":"https://vkarhune.github.io/finimom/reference/extract_subchain.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract a subchain from exsisting posterior samples, excluding a burn-in. — extract_subchain","title":"Extract a subchain from exsisting posterior samples, excluding a burn-in. — extract_subchain","text":"Extract subchain exsisting posterior samples, excluding burn-.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/extract_subchain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract a subchain from exsisting posterior samples, excluding a burn-in. — extract_subchain","text":"","code":"extract_subchain(posterior_sample, burnin = NULL, niter = NULL)"},{"path":"https://vkarhune.github.io/finimom/reference/extract_subchain.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract a subchain from exsisting posterior samples, excluding a burn-in. — extract_subchain","text":"posterior_sample Object posterior_samples(). burnin number initial iterations excluded. niter number iterations kept.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/extract_subchain.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract a subchain from exsisting posterior samples, excluding a burn-in. — extract_subchain","text":"Posterior samples burn-excluded.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/finimom.html","id":null,"dir":"Reference","previous_headings":"","what":"Fine-mapping using an inverse-moment prior. — finimom","title":"Fine-mapping using an inverse-moment prior. — finimom","text":"Fine-mapping using inverse-moment prior.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/finimom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fine-mapping using an inverse-moment prior. — finimom","text":"","code":"finimom(   beta,   se,   eaf,   R,   n = NULL,   cs = TRUE,   cs_level = 0.95,   pip = FALSE,   maxsize = 10,   tau = NULL,   r = 1,   niter = 12500,   burnin = 2500,   seed = 456,   excl.burnin = TRUE,   a0 = 1,   b0 = NULL,   u = NULL,   inds0 = NULL,   standardize = TRUE,   verbose = TRUE,   insampleLD = NULL,   clump = TRUE,   clump_r2 = 0.99^2,   check_ld = FALSE,   ala = NULL,   purity = NULL )"},{"path":"https://vkarhune.github.io/finimom/reference/finimom.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fine-mapping using an inverse-moment prior. — finimom","text":"beta Effect size estimates. se Standard errors. eaf Effect allele frequencies. R LD-matrix. n GWAS sample size. provided, tau calculated based n. cs credible sets returned? cs_level Credible set level. pip posterior inclusion probabilities returned? maxsize Maximum model size. tau Prior parameter tau. r Prior parameter r. niter Number iterations. burnin Number burn-iterations. seed Random seed. excl.burnin burn-excluded? a0 Hyperparameter model size prior. b0 Hyperparameter b model size prior (preferably use parameter u). u Hyperparameter model size prior. Defaults 2 -sample LD matrix 2.25 --sample LD matrix. inds0 Indices starting model. standardize effect sizes standardised? Defaults TRUE. verbose Verbose output. insampleLD -sample LD used? clump clumping done extremely highly-correlated variants? clump_r2 Clumping threshold extremely highly-correlated variants. check_ld LD discrepancy check performed? ala Whether Approximate Laplace used? purity Credible set purity, defined minimum absolute correlation variants credible set.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/finimom.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fine-mapping using an inverse-moment prior. — finimom","text":"List.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/g.html","id":null,"dir":"Reference","previous_headings":"","what":"Negative exponential of the Laplace approximation — g","title":"Negative exponential of the Laplace approximation — g","text":"Negative exponential Laplace approximation","code":""},{"path":"https://vkarhune.github.io/finimom/reference/g.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Negative exponential of the Laplace approximation — g","text":"","code":"g(x, beta, se, tau, psi, r, k, R)"},{"path":"https://vkarhune.github.io/finimom/reference/g.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Negative exponential of the Laplace approximation — g","text":"x Input beta Vector effect size estimates. se Vector standard errors effect size estimates. tau Parameter tau. psi Parameter psi (used). r Parameter r. k Model size. R LD matrix.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/g.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Negative exponential of the Laplace approximation — g","text":"Value.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/generate_sumstats.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — generate_sumstats","title":"Title — generate_sumstats","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/generate_sumstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — generate_sumstats","text":"","code":"generate_sumstats(phenotype, X, adj = NULL)"},{"path":"https://vkarhune.github.io/finimom/reference/generate_sumstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — generate_sumstats","text":"phenotype Phenotype. X Genotype matrix. adj Adjustments (defaults NULL).","code":""},{"path":"https://vkarhune.github.io/finimom/reference/generate_sumstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — generate_sumstats","text":"Summary statistics four columns: Effect size, standard error, log(p-value), p-value (note: min(p) = 1e-300, accurate given log(p-value)).","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_credible_sets.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain credible sets from the posterior samples. — get_credible_sets","title":"Obtain credible sets from the posterior samples. — get_credible_sets","text":"Obtain credible sets posterior samples.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_credible_sets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain credible sets from the posterior samples. — get_credible_sets","text":"","code":"get_credible_sets(samples, num_signals, level = 0.95, purity = purity, R = R)"},{"path":"https://vkarhune.github.io/finimom/reference/get_credible_sets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain credible sets from the posterior samples. — get_credible_sets","text":"samples Posterior samples posterior_samples() function. num_signals Number signals. level Probability level, default = 0.95. purity Credible set purity. R Correlation matrix.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_credible_sets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain credible sets from the posterior samples. — get_credible_sets","text":"List credible sets.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_csbf.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — get_csbf","title":"Title — get_csbf","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_csbf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — get_csbf","text":"","code":"get_csbf(beta, se, tau, r, level = 0.95)"},{"path":"https://vkarhune.github.io/finimom/reference/get_csbf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — get_csbf","text":"level","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_pips.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain posterior inclusion probabilities from the posterior samples. — get_pips","title":"Obtain posterior inclusion probabilities from the posterior samples. — get_pips","text":"Obtain posterior inclusion probabilities posterior samples.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_pips.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain posterior inclusion probabilities from the posterior samples. — get_pips","text":"","code":"get_pips(samples)"},{"path":"https://vkarhune.github.io/finimom/reference/get_pips.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain posterior inclusion probabilities from the posterior samples. — get_pips","text":"samples Posterior samples.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/get_pips.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain posterior inclusion probabilities from the posterior samples. — get_pips","text":"Posterior inclusion probabilities","code":""},{"path":"https://vkarhune.github.io/finimom/reference/logmk.html","id":null,"dir":"Reference","previous_headings":"","what":"Model size prior. — logmk","title":"Model size prior. — logmk","text":"Model size prior.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/logmk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Model size prior. — logmk","text":"","code":"logmk(lprior, k)"},{"path":"https://vkarhune.github.io/finimom/reference/logmk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Model size prior. — logmk","text":"lprior Output dbb. k Model size.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/logmk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Model size prior. — logmk","text":"Log-value model size prior.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/logmyb.html","id":null,"dir":"Reference","previous_headings":"","what":"Log-marginal likelihood for the data. — logmyb","title":"Log-marginal likelihood for the data. — logmyb","text":"Log-marginal likelihood data.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/logmyb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log-marginal likelihood for the data. — logmyb","text":"","code":"logmyb(x, se, tau, psi, r, k, R, gval)"},{"path":"https://vkarhune.github.io/finimom/reference/logmyb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log-marginal likelihood for the data. — logmyb","text":"x Vector effect sizes. se Vector standard errors. tau Parameter tau. psi Parameter psi (used). r Parameter r. k Model size. R LD matrix. gval Value g.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/logmyb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log-marginal likelihood for the data. — logmyb","text":"Value.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Samples from the posterior distribution — posterior_samples","title":"Samples from the posterior distribution — posterior_samples","text":"Samples posterior distribution","code":""},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Samples from the posterior distribution — posterior_samples","text":"","code":"posterior_samples(   beta,   se,   eaf,   R,   maxsize,   tau0,   r0,   niter,   burnin,   p,   seed = 456,   excl.burnin = TRUE,   a0 = 1,   b0 = NULL,   inds0 = NULL,   standardize = TRUE,   verbose = TRUE,   clump = TRUE,   clump_r2 = 0.99^2,   check_ld = FALSE,   ala = NULL )"},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Samples from the posterior distribution — posterior_samples","text":"beta Vector effect sizes. se Vector standard errors. eaf Vector effect allele frequencies. R LD matrix. maxsize maximum number causal variants. tau0 Parameter tau. r0 Parameter $r$. niter Number iterations. burnin Number burn-samples. p Number variants. seed Random seed. excl.burnin burn-excluded? a0 Hyperparameter model size prior. b0 Hyperparameter b model size prior. inds0 Initial model indices (used). standardize effect sizes standardised? Defaults TRUE. verbose Verbose output. clump Whether clump extremely highly correlated variants. clump_r2 Clumping threshold extremely highly correlated variants. check_ld Z-scores checked LD discrepancy? ala Whether Approximate Laplace used?","code":""},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Samples from the posterior distribution — posterior_samples","text":"List.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples2.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — posterior_samples2","title":"Title — posterior_samples2","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — posterior_samples2","text":"","code":"posterior_samples2(   beta,   se,   eaf,   R,   maxsize,   tau0,   r0,   niter,   burnin,   p,   seed = 456,   excl.burnin = TRUE,   n,   a0 = 0.05,   b0 = 0.95,   inds0 = NULL,   standardize = TRUE,   msprior = NULL,   verbose = TRUE,   clump = TRUE,   clump_r2 = 0.99^2,   check_ld = FALSE,   anchor = FALSE,   anchor_cslevel = 0.5 )"},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — posterior_samples2","text":"beta Vector effect sizes. se Vector standard errors. eaf Vector effect allele frequencies. R LD matrix. maxsize maximum number causal variants. tau0 Parameter tau. r0 Parameter $r$. niter Number iterations. burnin Number burn-samples. p Number variants. seed Random seed. excl.burnin burn-excluded? n Sample size (used). a0 Hyperparameter model size prior. b0 Hyperparameter b model size prior. inds0 Initial model indices (used). standardize effect sizes standardised? Defaults TRUE. msprior Model size prior (used). verbose Verbose output. anchor_cslevel","code":""},{"path":"https://vkarhune.github.io/finimom/reference/posterior_samples2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — posterior_samples2","text":"List.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/sample2.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — sample2","title":"Title — sample2","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/sample2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — sample2","text":"","code":"sample2(x, ...)"},{"path":"https://vkarhune.github.io/finimom/reference/sample2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — sample2","text":"x Vector. ... arguments sample.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/sample2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — sample2","text":"Value.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/select_causals.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — select_causals","title":"Title — select_causals","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/select_causals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — select_causals","text":"","code":"select_causals(   numcausals,   LDmat,   mincorr = 0.5,   maxcorr = 0.8,   minanycorr = 0.5 )"},{"path":"https://vkarhune.github.io/finimom/reference/select_causals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — select_causals","text":"numcausals Number causal variants. LDmat Linkage disequilibrium (LD) matrix, ie. correlation matrix variants. mincorr Minimum absolute correlation pair causal variants. maxcorr Maximum absolute correlation pair causal variants. minanycorr Minimum absolute correlation causal variant least one variant.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/select_causals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — select_causals","text":"Indices causal variants.","code":""},{"path":"https://vkarhune.github.io/finimom/reference/simulate_phenotype_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — simulate_phenotype_data","title":"Title — simulate_phenotype_data","text":"Title","code":""},{"path":"https://vkarhune.github.io/finimom/reference/simulate_phenotype_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — simulate_phenotype_data","text":"","code":"simulate_phenotype_data(   X,   N,   p,   causals,   R2,   seed,   meanbeta = 0,   sdbeta = 1,   minpower = NULL,   alpha = NULL )"},{"path":"https://vkarhune.github.io/finimom/reference/simulate_phenotype_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — simulate_phenotype_data","text":"X Genotype matrix. N Number individuals. p Number genetic variants. causals Indices causal variants. R2 Variance explained causal variants. seed Random seed. meanbeta Mean Gaussian effect sizes drawn . sdbeta Standard deviation Gaussian effect sizes drawn . alpha","code":""},{"path":"https://vkarhune.github.io/finimom/reference/simulate_phenotype_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Title — simulate_phenotype_data","text":"List phenotype betas, scaling var(Y) = 1.","code":""},{"path":"https://vkarhune.github.io/finimom/news/index.html","id":"finimom-010","dir":"Changelog","previous_headings":"","what":"finimom 0.1.0","title":"finimom 0.1.0","text":"Fixed obtain alternative number credible sets existing model.","code":""}]
